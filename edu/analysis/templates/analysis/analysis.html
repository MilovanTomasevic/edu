{% extends "base.html" %}

{% load static %}

{% block page_title %}<a class="h2 text-primary font-secondary" href="{% url 'analysis' %}">{{ header_api }}</a>{% endblock page_title %}
{% block page_title_details %}<li class="list-inline-item text-white h3 font-secondary nasted">{{ message_api }}</li>{% endblock page_title_details %}

{% block page_button %}<div class="col text-center"><a href="{% url 'ecenter-api' %}" class="btn btn-sm btn-primary-outline">API</a></div>{% endblock page_button %}

{% block content %}

<section class="section">
    <div class="container">
            <h4>Implementation of <b>chartJS</b> using <b>django</b></h4> 
          <hr/> 
            <div class="col-md-12"> 
              <canvas id="myChartline"></canvas> 
            </div></br>
            <div class="col-md-12"> 
              <canvas id="myChartBar"></canvas> 
            </div></br>
            <div class="col-md-12"> 
              <canvas id="myPolarArea"></canvas> 
            </div> 
    </div>
  </section>

{% endblock content %}

{% block extra_scripts %}

  <script> 

    var endpoint = '{% url 'ecenter-api' %}'; 

    $.ajax({ 
      method: "GET", 
      url: endpoint, 
      success: function(data) { 
        drawLineGraph(data, 'myChartline'); 
        drawBarGraph(data, 'myChartBar');
        drawPolarGraph(data, 'myPolarArea');
        console.log("drawing"); 
      }, 

      error: function(error_data) { 
        console.log(error_data); 
      } 
    }) 

    function drawLineGraph(data, id) { 
      var labels = data.labels; 
      var chartLabel = data.chartLabel; 
      var chartdata = data.chartdata; 
      var ctx = document.getElementById(id).getContext('2d'); 
      var chart = new Chart(ctx, { 

        // The type of chart we want to create 
        type: 'line', 

        // The data for our dataset 
        data: { 
          labels: labels, 
          datasets: [{ 
            label: chartLabel, 
            backgroundColor: 'rgb(255, 100, 200)', 
            borderColor: 'rgb(55, 99, 132)', 
            data: chartdata, 
          }] 
        }, 

        // Configuration options go here 
        options: { 
          scales: { 
            xAxes: [{ 
              display: true 
            }], 
            yAxes: [{ 
              ticks: { 
                beginAtZero: true 
              } 
            }] 
          } 
        } 
      }); 
    } 

  
    function drawBarGraph(data, id) { 
      var labels = data.labels; 
      var chartLabel = data.chartLabel; 
      var chartdata = data.chartdata; 
      var ctx = document.getElementById(id).getContext('2d'); 

      var myChart = new Chart(ctx, { 
        type: 'bar', 
        data: {
          labels: labels, 
          datasets: [{ 
            label: chartLabel, 
            data: chartdata, 
            backgroundColor: [ 
              'rgba(255, 99, 132, 0.2)', 
              'rgba(54, 162, 235, 0.2)', 
              'rgba(255, 206, 86, 0.2)', 
              'rgba(75, 192, 192, 0.2)', 
              'rgba(153, 102, 255, 0.2)', 
              'rgba(255, 159, 64, 0.2)' 
            ], 

            borderColor: [ 
              'rgba(255, 99, 132, 1)', 
              'rgba(54, 162, 235, 1)', 
              'rgba(255, 206, 86, 1)', 
              'rgba(75, 192, 192, 1)', 
              'rgba(153, 102, 255, 1)', 
              'rgba(255, 159, 64, 1)' 
            ], 
            borderWidth: 1 
          }] 
        }, 
        options: { 
          scales: {
            yAxes: [{ 
              ticks: { 
                beginAtZero: true 
              } 
            }] 
          } 
        } 
      }); 
    }

    function drawPolarGraph(data, id) { 
      var labels = data.labels; 
      var chartLabel = data.chartLabel; 
      var chartdata = data.chartdata; 
      var ctx = document.getElementById(id).getContext('2d'); 

        var myChart = new Chart(ctx, {
        type: 'horizontalBar',
        data: {
          labels: labels, 
          datasets: [{ 
            label: chartLabel, 
            data: chartdata, 
                backgroundColor: [
                    'rgba(255, 99, 132, 0.2)',
                    'rgba(54, 162, 235, 0.2)',
                    'rgba(255, 206, 86, 0.2)',
                    'rgba(75, 192, 192, 0.2)',
                    'rgba(153, 102, 255, 0.2)',
                    'rgba(255, 159, 64, 0.2)'
                ],
                borderColor: [
                    'rgba(255,99,132,1)',
                    'rgba(54, 162, 235, 1)',
                    'rgba(255, 206, 86, 1)',
                    'rgba(75, 192, 192, 1)',
                    'rgba(153, 102, 255, 1)',
                    'rgba(255, 159, 64, 1)'
                ],
                borderWidth: 1
            }]
        },
        options: {
            scales: {
                yAxes: [{
                    ticks: {
                        beginAtZero:true
                    }
                }]
            }
        }
        });
    } 
  </script>

{% endblock extra_scripts %}